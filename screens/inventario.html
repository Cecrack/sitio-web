<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Inventario - Ganadería Inteligente</title>
    <link rel="stylesheet" href="../styles/styleInventarios.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        /* Estilo para el menú desplegable */
        .dropdown-menu {
            display: none;
            position: absolute;
            right: 10px;
            top: 50px;
            background-color: #fff;
            border: 1px solid #ccc;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            padding: 10px;
            z-index: 100;
        }

        .dropdown-menu.active {
            display: block;
        }

        .dropdown-menu button {
            width: 100%;
            padding: 10px;
            border: none;
            background-color: transparent;
            text-align: left;
            font-size: 16px;
            cursor: pointer;
        }

        .dropdown-menu button:hover {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
    
    <div class="header">
        <button class="nav-toggle" id="nav-toggle" aria-label="Abrir menú">&#9776;</button>
        <div class="title" id="page-title">Gestión de inventario</div>
        <div class="user-info">
            <span id="session-status">Iniciar sesión</span>
            <div class="profile-circle" id="profile-icon" onclick="toggleDropdown()"></div>
            <div class="dropdown-menu" id="dropdown-menu">
                <button id="login-btn" onclick="openModal('login-form')">Iniciar sesión</button>
                <button id="create-user-btn" onclick="openModal('create-user-form')">Crear cuenta</button>
                <button id="logout-btn" class="hidden">Cerrar sesión</button>
            </div>
        </div>
    </div>
    

<!-- Contenedor principal -->
<div class="main-container">
   <!-- Menú lateral -->
   <nav class="menu-container" id="nav-menu">
    <button id="btn-inicio" onclick="window.location.href='../index.html';">Inicio</button>
    <button id="btn-inventario" class="active" onclick="window.location.href='inventario.html';">Gestión de Inventario</button>
    <button id="btn-reportes" onclick="window.location.href='reportes.html';">Reportes</button>
    <button id="btn-consulta" onclick="window.location.href='consulta.html';">Consulta</button>
    <button id="btn-panel" onclick="window.location.href='panelAdministracion.html';">Panel de Administración</button>
</nav>

    <!-- Área de contenido principal -->
    <div class="content" id="content">
        <!-- Botones superiores -->
        <div class="top-buttons">
            <!-- Botón Registrar Vaca -->
            <button id="btn-registrar" onclick="openModal('modal-registrar')" class="top-btn">
                <span class="material-icons btn-icon">add_circle_outline</span>
                <h3>Registrar vaca</h3>
            </button>
        
            <!-- Botón Consultar Vaca -->
            <button id="btn-consultar" onclick="openModal('modal-consultar')" class="top-btn">
                <span class="material-icons btn-icon">search</span>
                <h3>Consultar vaca</h3>
            </button>
        
            <!-- Botón Eliminar Vaca -->
            <button id="btn-eliminar" onclick="openModal('modal-eliminar')" class="top-btn">
                <span class="material-icons btn-icon">delete</span>
                <h3>Eliminar vaca</h3>
            </button>
        </div>
        

        <!-- DataGridView -->
        <table class="data-grid">
            <thead>
                <tr>
                    <th>Foto</th>
                    <th>RFID #</th>
                    <th>Nombre</th>
                    <th>Fecha Ingreso</th>
                    <th>Peso Actual</th>
                    <th>Estado Actual</th>
                    <th>Observaciones</th>
                </tr>
            </thead>
            <tbody>
                <!-- Aquí se cargarán los datos dinámicamente -->
            </tbody>
        </table>
    </div>
</div>

<!-- Ventanas emergentes -->
<div class="overlay" id="overlay"></div>

<div class="modal active" id="modal-registrar">
    <div class="modal-header">
        Registrar vaca
        <button class="modal-close" onclick="closeModal('modal-registrar')">X</button>
    </div>
    <div class="modal-body">
        <!-- Barra de progreso -->
        <div class="progress-bar">
            <div class="step active" id="step-1">1</div>
            <div class="step" id="step-2">2</div>
            <div class="step" id="step-3">3</div>
            <div class="step" id="step-4">4</div>
            <div class="step" id="step-5">5</div>
            <div class="step" id="step-6">6</div>
            <div class="step" id="step-7">7</div>
        </div>

        <!-- Contenedor de pasos -->
        <form id="register-form">
            <!-- Paso 1: Identificación -->
            <div class="step-content active" id="step-content-1">
                <h3>Identificación</h3>
                <label for="rfid">RFID Escaneado</label>
                <input type="text" id="rfid" class="form-input" placeholder="Esperando lectura...">
                <label for="id-interno">Número de identificación interno</label>
                <input type="text" id="id-interno" class="form-input" readonly>
            </div>
            




            <!-- Paso 2: Datos generales -->
            <div class="step-content" id="step-content-2">
                <h3>Datos Generales</h3>
                <label for="raza">Raza</label>
                <input type="text" id="raza" class="form-input">
                <label for="sexo">Sexo</label>
                <select id="sexo" class="form-input">
                    <option value="" disabled selected>Seleccionar</option>
                    <option value="macho">Macho</option>
                    <option value="hembra">Hembra</option>
                </select>
                <label for="peso">Peso (kg)</label>
                <input type="number" id="peso" class="form-input">
                <label for="fecha-ingreso">Fecha de ingreso</label>
                <input type="date" id="fecha-ingreso" class="form-input">
            </div>

            <!-- Paso 3: Datos sanitarios -->
            <div class="step-content" id="step-content-3">
                <h3>Datos Sanitarios</h3>
                <label for="historial-vacunacion">Historial de vacunación</label>
                <textarea id="historial-vacunacion" class="form-input"></textarea>
                <label for="fecha-desparasitacion">Fecha de última desparasitación</label>
                <input type="date" id="fecha-desparasitacion" class="form-input">
                <label for="estado-salud">Estado de salud</label>
                <select id="estado-salud" class="form-input">
                    <option value="" disabled selected>Seleccionar</option>
                    <option value="bueno">Bueno</option>
                    <option value="regular">Regular</option>
                    <option value="enfermo">Enfermo</option>
                </select>
            </div>

            <!-- Paso 4: Reproducción -->
            <div class="step-content" id="step-content-4">
                <h3>Reproducción</h3>
                <label for="estado-reproductivo">Estado reproductivo</label>
                <select id="estado-reproductivo" class="form-input">
                    <option value="" disabled selected>Seleccionar</option>
                    <option value="preñada">Preñada</option>
                    <option value="lactando">Lactando</option>
                    <option value="en-celo">En celo</option>
                    <option value="vacia">Vacía</option>
                </select>
                <label for="fecha-ultimo-parto">Fecha del último parto</label>
                <input type="date" id="fecha-ultimo-parto" class="form-input">
                <label for="numero-crias">Número de crías registradas</label>
                <input type="number" id="numero-crias" class="form-input">
            </div>

            <!-- Paso 5: Ubicación -->
            <div class="step-content" id="step-content-5">
                <h3>Ubicación</h3>
                <label for="corral">Corral o ubicación</label>
                <input type="text" id="corral" class="form-input">
            </div>

            <!-- Paso 6: Foto del animal -->
            <div class="step-content" id="step-content-6">
                <h3>Subir Foto</h3>
                <div class="form-group">
                    <button type="button" class="camera-btn">
                        <span class="material-icons camera-icon">photo_camera</span>
                        Abrir cámara
                    </button>
                </div>
                <label for="foto-animal">Subir archivo</label>
                <input type="file" id="foto-animal" class="form-input" accept="image/*">
            </div>

            <!-- Paso 7: Observaciones generales -->
            <div class="step-content" id="step-content-7">
                <h3>Observaciones Generales</h3>
                <label for="observaciones">Notas o particularidades del animal</label>
                <textarea id="observaciones" class="form-input"></textarea>
            </div>

            <!-- Botones de navegación -->
            <div class="navigation-buttons">
                <button type="button" class="nav-btn" id="prev-btn" disabled>Anterior</button>
                <button type="button" class="nav-btn" id="next-btn">Siguiente</button>
                <button type="submit" class="nav-btn hidden" id="submit-btn" disabled>Registrar</button>
            </div>
        </form>
    </div>
</div>


<!-- Modal para consultar vaca -->
<div class="modal" id="modal-consultar">
    <div class="modal-header">
        Consultar vaca
        <button class="modal-close" onclick="closeModal('modal-consultar')">
            <span class="material-icons">close</span>
        </button>
    </div>
    <div class="modal-body">
        <!-- Campo RFID -->
        <div class="form-group">
            <label class="rfid-label">RFID (en espera)</label>
            <p class="rfid-info">Acerca el sensor RFID al arete de la vaca</p>
        </div>

        <!-- Botón Consultar Vaca -->
        <div class="form-group">
            <button class="consult-btn">
                <span class="material-icons btn-icon">search</span>
                Consultar vaca
            </button>
        </div>
    </div>
</div>


<!-- Modal para eliminar vaca -->
<div class="modal" id="modal-eliminar">
    <div class="modal-header">
        Eliminar vaca
        <button class="modal-close" onclick="closeModal('modal-eliminar')">
            <span class="material-icons">close</span>
        </button>
    </div>
    <div class="modal-body">
        <!-- Campo Buscar por RFID -->
        <div class="form-group">
            <label class="rfid-label">Buscar por RFID</label>
            <input type="text" placeholder="RFID (en espera)" class="form-input">
            <p class="rfid-info">Acerca el sensor RFID al arete de la vaca</p>
        </div>
        <hr>
        <!-- Campo Buscar por Nombre -->
        <div class="form-group">
            <label class="name-label">Buscar por Nombre</label>
            <select class="form-combobox" id="cow-names" placeholder="Nombre">
                <option value="">Seleccione una vaca...</option>
                <!-- Nombres de vacas dinámicos -->
                <option value="vaca1">Vaca 1</option>
                <option value="vaca2">Vaca 2</option>
                <option value="vaca3">Vaca 3</option>
            </select>
        </div>

        <!-- Botón Eliminar Vaca -->
        <div class="form-group">
            <button class="delete-btn" onclick="confirmDelete()">
                <span class="material-icons btn-icon">delete</span>
                Eliminar vaca
            </button>
        </div>
    </div>
</div>

<script type="module" src="../script.js"></script>

<script>
    // Función para abrir o cerrar el menú desplegable del perfil
    function toggleDropdown() {
        const dropdown = document.getElementById('dropdown-menu');
        dropdown.classList.toggle('active');
    }

    // Función para manejar el cambio de estado de sesión (cerrar sesión)
    function cerrarSesion() {
        // Aquí puedes agregar la lógica para cerrar la sesión, por ejemplo, eliminar tokens de sesión, limpiar el estado, etc.
        document.getElementById('session-status').textContent = 'Iniciar sesión';
        alert('Sesión cerrada correctamente.');
        toggleDropdown(); // Cierra el menú al hacer clic en "Cerrar sesión"
    }

    // Lógica para mostrar el estado de sesión (esto debería ser dinámico dependiendo de si el usuario está autenticado)
    // Si el usuario está logueado, mostrar el nombre del usuario y opciones adecuadas.
    document.addEventListener("DOMContentLoaded", function() {
        const isAuthenticated = false; // Aquí deberías verificar si el usuario está autenticado

        if (isAuthenticated) {
            document.getElementById('session-status').textContent = 'Usuario autenticado'; // Mostrar nombre del usuario si está logueado
            document.getElementById('btn-iniciar-sesion').style.display = 'none'; // Ocultar botón "Iniciar sesión"
            document.getElementById('btn-crear-cuenta').style.display = 'none'; // Ocultar botón "Crear cuenta"
        } else {
            document.getElementById('session-status').textContent = 'Iniciar sesión'; // Estado cuando no está logueado
        }
    });
</script>
</body>
</html>
